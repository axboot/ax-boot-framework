"use strict";!function(){var e,t=ax5.ui,n=ax5.util;t.addClass({className:"menu"},function(){return function(){var i=this,u=void 0;this.instanceId=ax5.getGuid(),this.config={theme:"default",iconWidth:22,acceleratorWidth:100,menuBodyPadding:5,offset:{left:0,top:0},position:"fixed",animateTime:250,items:[],itemClickAndClose:!0,columnKeys:{label:"label",items:"items"}},this.openTimer=null,this.closeTimer=null,this.queue=[],this.menuBar={},this.state=void 0,u=this.config;var l=function(e,t){e?(jQuery(document).unbind("click.ax5menu-"+this.menuId).bind("click.ax5menu-"+this.menuId,o.bind(this,t)),jQuery(window).unbind("keydown.ax5menu-"+this.menuId).bind("keydown.ax5menu-"+this.menuId,function(e){e.which==ax5.info.eventKeys.ESC&&i.close()}),jQuery(window).unbind("resize.ax5menu-"+this.menuId).bind("resize.ax5menu-"+this.menuId,function(e){i.close()})):(jQuery(document).unbind("click.ax5menu-"+this.menuId),jQuery(window).unbind("keydown.ax5menu-"+this.menuId),jQuery(window).unbind("resize.ax5menu-"+this.menuId))},a=function(e,t){return e&&e.onStateChanged?e.onStateChanged.call(t,t):this.onStateChanged&&this.onStateChanged.call(t,t),i.state=t.state,e=null,t=null,!0},s=function(e){return this.onLoad&&this.onLoad.call(e,e),e=null,!0},c=function t(n,l,c,o){var d=n,r=void 0,h=void 0;return d.theme=n.theme||u.theme,d.cfg={icons:jQuery.extend({},u.icons),iconWidth:n.iconWidth||u.iconWidth,acceleratorWidth:n.acceleratorWidth||u.acceleratorWidth},l.forEach(function(e){e.html||e.divide?(e["@isMenu"]=!1,e.html&&(e["@html"]=e.html.call({item:e,config:u,opt:n}))):e["@isMenu"]=!0}),d[u.columnKeys.items]=l,d["@depth"]=c,d["@path"]=o||"root",d["@hasChild"]=function(){return this[u.columnKeys.items]&&this[u.columnKeys.items].length>0},r=jQuery(e.tmpl.get.call(this,"tmpl",d,u.columnKeys)),jQuery(document.body).append(r),h=this.queue.splice(c),h.forEach(function(e){e.$target.remove()}),this.queue.push({$target:r,data:jQuery.extend({},d)}),r.find("[data-menu-item-index]").bind("mouseover",function(){var e=this.getAttribute("data-menu-item-depth"),l=this.getAttribute("data-menu-item-index"),a=this.getAttribute("data-menu-item-path"),s=void 0,c=void 0,o=void 0,m=void 0,d=void 0,r=void 0;null!=e&&"undefined"!=typeof e&&(d=i.queue[e].data[u.columnKeys.items][l][u.columnKeys.items],r=i.queue[e].$target,r.find("[data-menu-item-index]").removeClass("hover"),jQuery(this).addClass("hover"),r.attr("data-selected-menu-item-index")!=l&&(r.attr("data-selected-menu-item-index",l),d&&d.length>0?(s=jQuery(this),c=s.offset(),o="fixed"==u.position?jQuery(document).scrollTop():0,m={"@parent":{left:c.left,top:c.top,width:s.outerWidth(),height:s.outerHeight()},left:c.left+s.outerWidth()-u.menuBodyPadding,top:c.top-u.menuBodyPadding-1-o},m=jQuery.extend(!0,n,m),t.call(i,m,d,Number(e)+1,a)):i.queue.splice(Number(e)+1).forEach(function(e){e.$target.remove()}))),e=null,l=null,a=null,s=null,c=null,o=null,m=null,d=null,r=null}),r.find("[data-menu-item-index]").bind("mouseout",function(){var e=this.getAttribute("data-menu-item-depth"),t=this.getAttribute("data-menu-item-index"),n=this.getAttribute("data-menu-item-path"),l=void 0;n&&(l=i.queue[e].data[u.columnKeys.items][t][u.columnKeys.items]),l&&l.length>0||jQuery(this).removeClass("hover")}),0==c&&(d.direction&&r.addClass("direction-"+d.direction),a.call(this,null,{self:this,items:l,parent:function(e){if(!e)return!1;var t=null;try{t=Function("","return this.config.items["+e.substring(5).replace(/\./g,"].items[")+"];").call(i)}catch(e){}return t}(d["@path"]),state:"popup"})),m.call(this,r,d),s.call(this,{self:this,items:l,element:r.get(0)}),d=null,r=null,h=null,n=null,l=null,c=null,o=null,this},o=function(e,t){var l=void 0,a=void 0;if(l=n.findParentNode(t.target,function(e){if(e.getAttribute("data-menu-item-index"))return!0})){if("undefined"==typeof e&&(e={}),a=function(t){if(!t)return!1;var n=void 0;try{n=Function("","return this["+t.substring(5).replace(/\./g,"]."+u.columnKeys.items+"[")+"];").call(e.items||u.items)}catch(e){console.log(ax5.info.getError("ax5menu","501","menuItemClick"))}try{return n}finally{n=null}}(l.getAttribute("data-menu-item-path")),!a)return this;a.check&&(function(e){var t={checkbox:function(e){this.checked=!e},radio:function(t){var n=this.name;e.forEach(function(e){e.check&&"radio"===e.check.type&&e.check.name==n&&(e.check.checked=!1)}),this.checked=!t}};t[this.type]&&t[this.type].call(this,this.checked),t=null}.call(a.check,u.items),u.itemClickAndClose||i.queue.forEach(function(e){e.$target.find("[data-menu-item-index]").each(function(){var t=e.data[u.columnKeys.items][this.getAttribute("data-menu-item-index")];t.check&&jQuery(this).find(".item-checkbox-wrap").attr("data-item-checked",t.check.checked)})})),i.onClick&&i.onClick.call(a,a,e.param)&&i.close(),a[u.columnKeys.items]&&0!=a[u.columnKeys.items].length||!u.itemClickAndClose||i.close()}else i.close();return l=null,a=null,this},m=function(e,t){var n=jQuery(window),i=jQuery(document),l="fixed"==u.position?n.height():i.height(),a=n.width(),s=e.outerHeight(),c=e.outerWidth(),o=t.left,m=t.top,d=u.position||"fixed";return o+c>a&&(o=t["@parent"]?t["@parent"].left-c+u.menuBodyPadding:a-c),m+s>l&&(m=l-s),e.css({left:o,top:m,position:d}),e=null,t=null,n=null,i=null,l=null,a=null,s=null,c=null,o=null,m=null,d=null,this};this.init=function(){i.menuId=ax5.getGuid(),this.onStateChanged=u.onStateChanged,this.onClick=u.onClick,this.onLoad=u.onLoad,a.call(this,null,{self:this,state:"init"})},this.popup=function(){var e={event:function(e,t){e={left:e.clientX,top:"fixed"==u.position?e.clientY:e.pageY,width:u.width,theme:u.theme},e.left-=5,e.top-=5,u.offset&&(u.offset.left&&(e.left+=u.offset.left),u.offset.top&&(e.top+=u.offset.top)),t=jQuery.extend(!0,e,t);try{return t}finally{e=null}},object:function(e,t){e={left:e.left,top:e.top,width:e.width||u.width,theme:e.theme||u.theme},u.offset&&(u.offset.left&&(e.left+=u.offset.left),u.offset.top&&(e.top+=u.offset.top)),t=jQuery.extend(!0,e,t);try{return t}finally{e=null}}},t=function(e){e&&(u.theme=e)};return function(n,i){if(!n)return this;i=e["undefined"==typeof n.clientX?"object":"event"].call(this,n,i),t(i.theme);var a=[].concat(u.items),s=void 0;return i.items=a,i.filter&&(s=function(e){var t=[];return e.forEach(function(e){e.items&&e.items.length>0&&(e.items=s(e.items)),i.filter.call(e)&&t.push(e)}),t},i.items=a=s(a)),a.length&&(c.call(this,i,a,0),this.popupEventAttachTimer&&clearTimeout(this.popupEventAttachTimer),this.popupEventAttachTimer=setTimeout(function(){l.call(this,!0,i)}.bind(this),500)),n=null,this}}(),this.attach=function(){var t={object:function(e,t){e={left:e.left,top:e.top,width:e.width||u.width,theme:e.theme||u.theme,direction:e.direction||u.direction},t=jQuery.extend(!0,t,e);try{return t}finally{e=null,t=null}}},a=function(e,n,a){var s=jQuery(e),o=s.offset(),m=s.outerHeight(),d=Number(e.getAttribute("data-menu-item-index")),r="fixed"==u.position?jQuery(document).scrollTop():0;if(u.items&&u.items[d][u.columnKeys.items]&&u.items[d][u.columnKeys.items].length){if(i.menuBar.openedIndex==d)return"click"==a&&i.close(),!1;i.menuBar.target.find("[data-menu-item-index]").removeClass("hover"),i.menuBar.opened=!0,i.menuBar.openedIndex=d,s.attr("data-menu-item-opened","true"),s.addClass("hover"),u.offset&&(u.offset.left&&(o.left+=u.offset.left),u.offset.top&&(o.top+=u.offset.top)),n=t.object.call(this,{left:o.left,top:o.top+m-r},n),c.call(i,n,u.items[d][u.columnKeys.items],0,"root."+e.getAttribute("data-menu-item-index")),l.call(i,!0,{})}e=null,n=null,s=null,o=null,m=null,d=null,r=null},s=function(e,t,n){var l=jQuery(e),a=(l.offset(),l.outerHeight(),Number(e.getAttribute("data-menu-item-index")));"fixed"==u.position?jQuery(document).scrollTop():0;!u.items||u.items[a][u.columnKeys.items]&&0!=u.items[a][u.columnKeys.items].length||i.onClick&&i.onClick.call(u.items[a],u.items[a])};return function(t,l){var c,o={},m=u.items;return"undefined"==typeof l&&(l={}),o.theme=l.theme||u.theme,o.cfg={icons:jQuery.extend({},u.icons),iconWidth:l.iconWidth||u.iconWidth,acceleratorWidth:l.acceleratorWidth||u.acceleratorWidth},m.forEach(function(e){e.html||e.divide?(e["@isMenu"]=!1,e.html&&(e["@html"]=e.html.call({item:e,config:u,opt:l}))):e["@isMenu"]=!0}),o[u.columnKeys.items]=m,c=jQuery(e.tmpl.get.call(this,"tmplMenubar",o,u.columnKeys)),i.menuBar={target:jQuery(t),opened:!1},i.menuBar.target.html(c),i.menuBar.target.bind("click",function(e){if(!e)return this;var t=n.findParentNode(e.target,function(e){if(e.getAttribute("data-menu-item-index"))return!0});t&&(s(t,l,"click"),a(t,l,"click")),t=null}),i.menuBar.target.bind("mouseover",function(e){if(!i.menuBar.opened)return!1;var t=n.findParentNode(e.target,function(e){if(e.getAttribute("data-menu-item-index"))return!0});t&&a(t,l,"mouseover"),t=null}),t=null,l=null,o=null,m=null,c=null,this}}(),this.close=function(){return i.menuBar&&i.menuBar.target&&(i.menuBar.target.find("[data-menu-item-index]").removeClass("hover"),i.menuBar.opened=!1,i.menuBar.openedIndex=null),l.call(this,!1),this.queue.forEach(function(e){e.$target.remove()}),this.queue=[],a.call(this,null,{self:this,state:"close"}),this},this.getCheckValue=function(){var e={},t=function(i){for(var u=i.length;u--;)i[u].check&&i[u].check.checked&&(e[i[u].check.name]?(n.isString(e[i[u].check.name])&&(e[i[u].check.name]=[e[i[u].check.name]]),e[i[u].check.name].push(i[u].check.value)):e[i[u].check.name]=i[u].check.value),i[u].items&&i[u].items.length>0&&t(i[u].items)};t(u.items);try{return e}finally{e=null,t=null}},this.main=function(){t.menu_instance=t.menu_instance||[],t.menu_instance.push(this),arguments&&n.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)}}()),e=ax5.ui.menu}(),function(){var e=ax5.ui.menu,t=function(e){return'\n        <div class="ax5-ui-menu {{theme}}" {{#width}}style="width:{{width}}px;"{{/width}}>\n            <div class="ax-menu-body">\n                {{#'+e.items+'}}\n                    {{^@isMenu}}\n                        {{#divide}}\n                        <div class="ax-menu-item-divide" data-menu-item-index="{{@i}}"></div>\n                        {{/divide}}\n                        {{#html}}\n                        <div class="ax-menu-item-html" data-menu-item-index="{{@i}}">{{{@html}}}</div>\n                        {{/html}}\n                    {{/@isMenu}}\n                    {{#@isMenu}}\n                    <div class="ax-menu-item" data-menu-item-depth="{{@depth}}" data-menu-item-index="{{@i}}" data-menu-item-path="{{@path}}.{{@i}}">\n                        <span class="ax-menu-item-cell ax-menu-item-checkbox">\n                            {{#check}}\n                            <span class="item-checkbox-wrap useCheckBox" {{#checked}}data-item-checked="true"{{/checked}}></span>\n                            {{/check}}\n                            {{^check}}\n                            <span class="item-checkbox-wrap"></span>\n                            {{/check}}\n                        </span>\n                        {{#icon}}\n                        <span class="ax-menu-item-cell ax-menu-item-icon" style="width:{{cfg.iconWidth}}px;">{{{.}}}</span>\n                        {{/icon}}\n                        <span class="ax-menu-item-cell ax-menu-item-label">{{{'+e.label+'}}}</span>\n                        {{#accelerator}}\n                        <span class="ax-menu-item-cell ax-menu-item-accelerator" style="width:{{cfg.acceleratorWidth}}px;"><span class="item-wrap">{{.}}</span></span>\n                        {{/accelerator}}\n                        {{#@hasChild}}\n                        <span class="ax-menu-item-cell ax-menu-item-handle">{{{cfg.icons.arrow}}}</span>\n                        {{/@hasChild}}\n                    </div>\n                    {{/@isMenu}}\n\n                {{/'+e.items+'}}\n            </div>\n            <div class="ax-menu-arrow"></div>\n        </div>\n        '},n=function(e){return'\n        <div class="ax5-ui-menubar {{theme}}">\n            <div class="ax-menu-body">\n                {{#'+e.items+'}}\n                    {{^@isMenu}}\n                        {{#divide}}\n                        <div class="ax-menu-item-divide" data-menu-item-index="{{@i}}"></div>\n                        {{/divide}}\n                        {{#html}}\n                        <div class="ax-menu-item-html" data-menu-item-index="{{@i}}">{{{@html}}}</div>\n                        {{/html}}\n                    {{/@isMenu}}\n                    {{#@isMenu}}\n                    <div class="ax-menu-item" data-menu-item-index="{{@i}}">\n                        {{#icon}}\n                        <span class="ax-menu-item-cell ax-menu-item-icon" style="width:{{cfg.iconWidth}}px;">{{{.}}}</span>\n                        {{/icon}}\n                        <span class="ax-menu-item-cell ax-menu-item-label">{{{'+e.label+"}}}</span>\n                    </div>\n                    {{/@isMenu}}\n                {{/"+e.items+"}}\n            </div>\n        </div>\n        "};e.tmpl={tmpl:t,tmplMenubar:n,get:function(t,n,i){return ax5.mustache.render(e.tmpl[t].call(this,i),n)}}}();
//# sourceMappingURL=ax5menu.min.js.map
